---
title: "Mini-Project 2"
author: "Liu Sifan & Ziheng Ru & Runxin Wang"
date: "October 31, 2017"
output: html_document
---

```{r}
library(dplyr)
library(tidyverse)
```

```{r}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r}
house_elections <-
  rename(house_elections, cand_name = candidate_name )
```

```{r}
Fl_winner <- house_elections %>%
  filter(state == "FL") %>%
  filter(ge_winner == "W") %>%
  filter(party == "R"| party == "D")
List_winner1 <- Fl_winner %>%
  select("cand_name","fec_id") %>%
  rename("cand_id"="fec_id")
List_winner1
```

```{r}
Fl_general_candidates <- house_elections %>%
  filter(state == "FL") %>%
  filter(ge_winner == "W"| general_votes > 0 & ge_winner == "N") %>%
  filter(party == "R"| party == "D") %>%
  select("cand_name","fec_id","district","general_votes","ge_winner") %>%
  rename("cand_id"="fec_id")
Fl_general_candidates
```



```{r}
FL_win <- Fl_winner %>%
  summarise(N = n(),
            r = sum(party == "R")) %>%
  mutate(r_percentage = r/N)
FL_win
```

```{r}
committees_contribution <- committees %>%
  left_join(contributions, by = "cmte_id")
```

```{r}
committees_contribution <- committees_contribution %>%
  rename( cand_id = cand_id.y)
```

```{r}
committees_contribution_2 <- committees_contribution %>%
  right_join(candidates, by = "cand_id")
```

```{r}
FL_dataset <- committees_contribution_2 %>%
  right_join(Fl_general_candidates, by="cand_id") %>%
  filter(cand_office=="H" ) %>%
  filter(cmte_party_affiliation=="DEM" | cmte_party_affiliation=="REP") %>%
  filter(transaction_type=="24A" | transaction_type=="24E") %>%
  rename(cand_name= cand_name.y) %>%
  select("cand_name","district","ge_winner","cand_id","cand_party_affiliation","cmte_party_affiliation","cmte_name","cmte_id","cmte_state","cmte_type","transaction_type","transaction_amt","memo_text")
FL_dataset
```
```{r}
FL_dataset %>%
  group_by(district) %>%
  filter(transaction_type=="24E")



```